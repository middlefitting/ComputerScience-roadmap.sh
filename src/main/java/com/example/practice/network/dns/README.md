## 개요

인터넷 사용자들은 웹 브라우저에서 www.naver.com 과 같은 도메인 주소로 인터넷을 사용합니다.
DNS는 도메인 주소를 IP 주소로 변환시키는 역할을 수행합니다.
모든 인터넷 장치에는 고유한 IP 주소가 있습니다. DNS를 통해 사용자들은 복잡한 IPv4 및 IPv6 주소를 외우지 않아도 인터넷을 사용할 수 있습니다.

## DNS의 작동방식

DNS의 동작은 도메인 주소를 컴퓨터 친화적인 IP 주소로 변환하는 것으로 동작합니다.
이러한 프로세스는 사용자가 웹 브라우저에 주소를 입력하였을 때, 백그라운드에서 동작하게 됩니다.

## 웹페이지 로딩에 필요한 4개의 DNS 서버

### DNS recursor

책을 찾는 도서관의 사서와 같은 역할과 유사합니다. 클라이언트 시스템(웹 브라우저)으로부터 쿼리를 수신하도록 설계된 서버입니다.
일반적으로 클라이언트의 DNS 쿼리를 충족시키기 위한 추가적인 요청을 담당합니다.
재귀적 서버는 혼자 IP 주소를 아는 것이 아니라 다른 DNS 서버들에게 물어보며 정보를 찾아가는 재귀적 조회를 수행합니다.

### Root nameserver

사람이 읽을 수 있는 호스트명을 IP 주소로 변환하는 첫번째 단계입니다. 도서의 색인과 유사하다고 생각할 수 있습니다.
루트 네임서버는 직접적으로 도메인의 IP 주소는 모르지만, 어떤 상위 그룹(.com, .net)의 서버로 가야 할지 안내를 해주게 됩니다.
recursor가 루트 네임서버로 요청을 보내면 이를 TLD 서버로 보내주게 도비니다.

### TLD 네임서버

최상위 도메인 서버를 의미합니다. 도서관의 특정 책의 랙으로 생각할 수 있습니다.
호스트 명의 마지막 부분을 호스팅합니다. 그 예시로 example.com의 TLD 서버는 com입니다.
최상위 도메인을 관리하며, 그 하위에 있는 도메인들의 정보를 알고 있기 때문에 최종 정보를 관리하는 Authoritative nameserver로 요청을 보내게 됩니다.

### Authoritative nameserver

최종 네임서버로서 특정 이름을 해당 정의로 변환할 수 있는 책꽃이에 있는 사진입니다.
즉 도메인에 연결된 실제 IP 주소를 알고 있으며, 클라이언트의 요청을 해결할 수 있는 최종 단계입니다.
네임서버 쿼리의 마지막 중지시점으로 요청된 레코드에 액세스가 가능한 경우 IP 주소를 DNS Recursor에게 다시 반환합니다.

## Authoritative nameserver vs Recursive DNS resolver

### Recursive DNS resolver

클라이언트가 보낸 재귀적인 요청에 응답하고, DNS 레코드를 추적합니다.
재귀적 요청에서 Authoritative nameserver에 도달하거나 시간초과와 같은 이벤트가 일어날때까지 이루어집니다.
이러한 요청을 매번 수행하지 않도록 캐싱을 제공하기도 합니다.

### Authoritative DNS server

실제로 DNS 리소스 레코드를 보유하고 이를 담당하는 서버입니다. DNS 조회 체인의 가장 하단에 존재합니다.

### DNS lookup

### 8 Steps in a DNS lookup

- 사용자가 도메인을 입력하면 쿼리가 인터넷으로 인해 DNS recursive resolver에서 수신됩니다.
- resolver는 root namerserver
- 루트 네입서버는 해당 도메인의(.com) 최상위 도메인을 아는 TLD 주소로 응답합니다.
- resolver는 TLD로 요청을 보냅니다.
- TLD는 해당 도메인의 IP를 보내줍니다.
- resolver는 도메인 네임서버로 쿼리를 보냅니다.
- example.com의 IP를 도메인 네임서버가 응답합니다.
- DNS resolver는 전달받은 IP 주소를 웹 브라우저에게 알려줍니다.
- 브라우저는 해당 IP로 HTTP 요청을 보냅니다.
- 서버는 요청에 대한 응답을 보내줍니다.

### 3 types of DNS queries

- recursive: 확인자가 레코드를 찾을 수 없는 경우
- iterative: 서버가 가능한 최상의 답변을 하도록 하는 것
- non-recursive: 레코드에 대한 권한이 있거나 캐시된 결과가 존재하는 경우 (브라우저 및 운영체제에서도 DNS를 캐싱합니다)

## DNS Record

도메인과 관련된 여러 정보가 저장되어 있으며, DNS 서버에게 요청을 처리하는 방법을 지시하는 명령어로 구성되어 있습니다.
각 레코드에는 TTL 값이 포함되어 있는데요, 이는 DNS 레코드가 변경되었을때, 인터넷 전역의 DNS 서버에 전파되기까지의 시간을 의미합니다.

### A 레코드#

도메인 이름을 IPv4 주소로 매핑합니다. ex) example.com -> 192.168.1.1

### AAAA 레코드

도메인 주소를 IPv6 주소로 매핑합니다. ex) example.com -> 2001:0db8:85a3:0000:0000:8a2e:0370:7334

### CNAME 레코드

별칭을 설정하는데 사용됩니다. 하나의 도메인이 다른 도메인으로 리다이렉션 되거나, 여러 도메인이 동일한 IP 주소를 가리킬 때 유용합니다.
ex) www.example.com -> example.com

### MX 레코드

도메인과 관련된 메일 서버를 지정합니다. 이메일 수신자의 메일 서버를 찾아주는 역할을 수행합니다.
ex) example.com -> mail.example.com

### NS 레코드

도메인의 권한있는 네임서버를 지정합니다. 도메인의 대한 모든 DNS 조회를 처리하는 서버의 위치입니다.
ex) example.com -> ns1.example.com

### SRV 레코드

특정 서비스가 동작하는 서버의 위치와 포트를 지정하는데 사용됩니다.

### PTR 레코드

IP 주소를 도메인 이름으로 변환하는데 사용됩니다.

### SOA 레코드

DNS 영역에 대한 권한을 정의합니다. 도메인 관리자 정보, 갱신 간격, 마지막 업데이트 시간이 포함됩니다.
